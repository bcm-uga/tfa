<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Factor analysis of temporal or ancient DNA samples — tfa • tfa</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Factor analysis of temporal or ancient DNA samples — tfa" />

<meta property="og:description" content="tfa estimates factors describing population structure for temporal samples
of DNA, correcting individual scores for the effect of allele frequency drift through time" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tfa-vignette.html">Analyzing ancient DNA data with the R package tfa</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Factor analysis of temporal or ancient DNA samples</h1>
    
    <div class="hidden name"><code>tfa.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>tfa</code> estimates factors describing population structure for temporal samples
of DNA, correcting individual scores for the effect of allele frequency drift through time</p>
    
    </div>

    <pre class="usage"><span class='fu'>tfa</span>(<span class='no'>sample_ages</span>, <span class='no'>Y</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>cov_matrix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>coverage</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sample_ages</th>
      <td><p>a numeric vector corresponding to the age of each sample where age = 0 is for
present-day individuals. By default, ages are converted into normalized dates between 0 and 1
(date = 1 for present-day individuals).</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>an nxp numeric matrix containing genetic information for n individuals recorded in p columns.
Genetic information could be encoded by any numeric value, not necessarily an integer value. Missing data are not allowed.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>an integer value for the number of factor to compute. The default value is k = 2.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>a nonnegative numeric value which corresponds to the drift parameter (noise-to-temporal-signal ratio).</p></td>
    </tr>
    <tr>
      <th>cov_matrix</th>
      <td><p>a user-specified prior covariance matrix for the n samples. If <code>NULL</code>,
the prior matrix is computed as
<code>C[i,j] = min(t_i, t_j)</code>,
where <code>t_i</code> and <code>t_j</code> are the normalized sample dates, taking values between 0 and 1. The option is
useful when the sample size is large, and when the user wants to use a pre-computed covariance matrix
to save time.</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>a logical value indicating whether the genetic values should be centered by substracting
their row mean.</p></td>
    </tr>
    <tr>
      <th>coverage</th>
      <td><p>a numerical vector containing information on DNA sample coverage. Note that
coverage differences might strongly bias factor analysis results. Including coverage information
allows the program to adjust for coverage bias by using a local regression (<code>loess</code>).
We also suggest that correction of the data for low coverage should be performed before analysis by using the function <code>coverage_adjust</code>.</p></td>
    </tr>
    <tr>
      <th>log</th>
      <td><p>a logical value indicating that corrections are performed from <code><a href='https://rdrr.io/r/base/Log.html'>log(coverage)</a></code>
instead of <code>coverage</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following attributes:</p><dl class='dl-horizontal'>
   <dt>u</dt><dd><p>an nxk numeric matrix containing the k corrected factors</p></dd>
   <dt>singular.values</dt><dd><p>a vector of size n containing the singular values</p></dd>
   <dt>tn</dt><dd><p>a vector containing the normalized sample dates</p></dd>
   <dt>cov</dt><dd><p>the C matrix used for correction (default: Brownian covariance matrix)</p></dd>

</dl>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>François, O., Liégeois, S., Demaille, B., Jay, F. (2019). Inference of population genetic structure from temporal samples
of DNA. bioRxiv, 801324. <a href='https://www.biorxiv.org/content/10.1101/801324v3'>https://www.biorxiv.org/content/10.1101/801324v3</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='England_BA.html'>England_BA</a></code>, <code><a href='coverage_adjust.html'>coverage_adjust</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>tfa</span>)

<span class='co'># Ancient DNA from Bronze Age Great Britain samples</span>
<span class='co'># including Yamnaya, early farmers (Anatolia) and hunter-gatherers (Serbia)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>england_ba</span>)

<span class='fu'><a href='https://rdrr.io/r/base/attach.html'>attach</a></span>(<span class='no'>England_BA</span>)
<span class='no'>coverage</span> <span class='kw'>&lt;-</span> <span class='no'>meta</span>$<span class='no'>Coverage</span>
<span class='no'>geno</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='coverage_adjust.html'>coverage_adjust</a></span>(<span class='no'>genotype</span>, <span class='no'>coverage</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='no'>mod</span>  <span class='kw'>&lt;-</span> <span class='fu'>tfa</span>(<span class='no'>age</span>,
            <span class='no'>geno</span>,
            <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>2</span>,
            <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>5e-1</span>,
            <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
            <span class='kw'>coverage</span> <span class='kw'>=</span> <span class='no'>coverage</span>,
            <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"grey90"</span>,
     <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Factor 1"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Factor 2"</span>,
     <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"FA"</span>)</div><div class='input'>
<span class='no'>m_yamnaya</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span> <span class='st'>"Russia_Yamnaya"</span>,],
                   <span class='fl'>2</span>, <span class='no'>mean</span>)
<span class='no'>m_anatolia</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span> <span class='st'>"Anatolia_N"</span>,],
                    <span class='fl'>2</span>, <span class='no'>mean</span>)
<span class='no'>m_hg</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span> <span class='st'>"Serbia_HG"</span>,],
              <span class='fl'>2</span>, <span class='no'>mean</span>)

<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>m_yamnaya</span>, <span class='no'>m_anatolia</span>, <span class='no'>m_hg</span>), <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>m_yamnaya</span>, <span class='no'>m_anatolia</span>, <span class='no'>m_hg</span>, <span class='no'>m_yamnaya</span>))</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span> <span class='st'>"Russia_Yamnaya"</span>,],
       <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkblue"</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span> <span class='st'>"Anatolia_N"</span>,],
       <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"salmon3"</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span>  <span class='st'>"Serbia_HG"</span>,],
       <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"olivedrab"</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span> <span class='st'>"England_Bell_Beaker"</span>,],
       <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"yellow4"</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>==</span> <span class='st'>"England_BA"</span>,],
       <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"yellow3"</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>mod</span>$<span class='no'>u</span>[<span class='no'>meta</span>$<span class='no'>Group.ID</span> <span class='kw'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"England_N"</span>, <span class='st'>"Scotland_N"</span>),],
       <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"salmon1"</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>y</span> <span class='kw'>=</span> -<span class='fl'>15</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>,
       <span class='kw'>legend</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Early Farmers"</span>, <span class='st'>"Hunter Gatherers"</span>, <span class='st'>"Steppe"</span>),
       <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"salmon3"</span>, <span class='st'>"olivedrab"</span>, <span class='st'>"darkblue"</span>), <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>8</span>)</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>20.5</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.6</span>,
       <span class='kw'>legend</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Neolithic GB"</span>, <span class='st'>"Bronze Age GB"</span>, <span class='st'>"Bell Beaker"</span>),
       <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"salmon1"</span>, <span class='st'>"yellow3"</span>, <span class='st'>"yellow4"</span>), <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>)</div><div class='img'><img src='tfa-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/detach.html'>detach</a></span>(<span class='no'>England_BA</span>)
<span class='co'># rm(list = ls())</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Olivier Francois, <a href='mailto:olivier.francois@univ-grenoble-alpes.fr'>olivier.francois@univ-grenoble-alpes.fr</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Olivier Francois.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


